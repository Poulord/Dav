<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lumina Studio — Laboratorio visual</title>
  <link rel="stylesheet" href="styles.css" />
  <script async src="https://docs.opencv.org/4.x/opencv.js"></script>
  <script defer src="app.js"></script>
</head>
<body>
  <div class="page">
    <header class="topbar">
      <div class="brand">
        <div class="badge badge-neo">Lumina Studio</div>
        <div>
          <p class="hero-tag">Laboratorio visual en tiempo real</p>
          <h1>Explora fusiones creativas entre imágenes</h1>
        </div>
      </div>
      <div class="hero-stats">
        <div>
          <span class="stat-label">Modo</span>
          <strong>Experimental</strong>
        </div>
        <div>
          <span class="stat-label">Formato</span>
          <strong>Imágenes locales</strong>
        </div>
        <div>
          <span class="stat-label">Motor</span>
          <strong>OpenCV.js</strong>
        </div>
      </div>
    </header>

    <main class="layout">
      <section class="intro-card">
        <div>
          <h2>¿Qué hace este laboratorio?</h2>
          <p>
            Combina dos imágenes mediante filtros matemáticos y lógicos para crear
            composiciones, fusiones y efectos de iluminación.
          </p>
        </div>
        <p>
          Elige un filtro, ajusta el nivel de mezcla cuando corresponda y obtén el
          resultado en tiempo real. Ideal para prototipar ideas visuales rápidas.
        </p>
      </section>

      <aside class="sidebar">
        <section class="card operation-card" data-category="arithmetic" id="operationCard">
          <div class="operation-header">
            <div class="operation-icon" id="operationIcon" aria-hidden="true">➕</div>
            <div>
              <h3>Filtro activo</h3>
              <p class="muted">Define cómo se mezcla la información entre A y B.</p>
            </div>
          </div>

          <label class="field">
            Filtro
            <div class="field-control">
              <select id="op">
                <option value="add">add (A + B)</option>
                <option value="subtract">subtract (A - B)</option>
                <option value="multiply">multiply (A × B)</option>
                <option value="lighten">lighten (max)</option>
                <option value="blend">blend (addWeighted)</option>
              </select>
              <span class="hint-icon" title="Elige el tipo de operación entre las imágenes">ⓘ</span>
            </div>
          </label>

          <div id="blendControls" class="blend-controls" style="display: none;">
            <label class="field">
              Alpha (A)
              <input id="alpha" type="range" min="0" max="1" value="0.5" step="0.01" />
            </label>
            <div class="footer-note">Beta (B) = 1 - alpha</div>
          </div>

          <div class="operation-explanation" id="filterExplanation"></div>

          <div class="controls">
            <label class="toggle">
              <input id="autoResize" type="checkbox" checked />
              <span class="toggle-ui" aria-hidden="true"></span>
              Ajustar tamaño automáticamente
            </label>
            <div class="status" id="status">Cargando OpenCV.js...</div>
            <div class="buttons">
              <button class="primary" id="run">
                <span class="btn-icon">⚡</span>
                <span data-role="label">Aplicar operación</span>
              </button>
              <button class="secondary" id="clear">Limpiar</button>
            </div>
          </div>
        </section>
      </aside>

      <section class="workspace">
        <div class="image-grid">
          <section class="card image-card">
            <div class="card-header">
              <h3>Imagen A</h3>
              <span class="pill">Base</span>
            </div>
            <div class="upload-zone" id="uploadZoneA">
              <div class="upload-placeholder">
                <span class="placeholder-icon"></span>
                <div>
                  <strong>Arrastra y suelta la imagen</strong>
                  <p>o haz clic para seleccionar desde tu dispositivo</p>
                </div>
              </div>
              <input id="fileA" type="file" accept="image/*" />
            </div>
            <div class="upload-meta">
              <span id="fileNameA">Sin archivo</span>
              <span id="resolutionA">0×0</span>
            </div>
            <canvas id="canvasA"></canvas>
          </section>

          <section class="card image-card">
            <div class="card-header">
              <h3>Imagen B</h3>
              <span class="pill">Secundaria</span>
            </div>
            <div class="upload-zone" id="uploadZoneB">
              <div class="upload-placeholder">
                <span class="placeholder-icon"></span>
                <div>
                  <strong>Arrastra y suelta la imagen</strong>
                  <p>o haz clic para seleccionar desde tu dispositivo</p>
                </div>
              </div>
              <input id="fileB" type="file" accept="image/*" />
            </div>
            <div class="upload-meta">
              <span id="fileNameB">Sin archivo</span>
              <span id="resolutionB">0×0</span>
            </div>
            <canvas id="canvasB"></canvas>
          </section>
        </div>

        <section class="card result-card" id="resultCard">
          <div class="card-header">
            <div>
              <h3>Resultado</h3>
              <p class="muted">Vista final de la operación aplicada.</p>
            </div>
            <div class="result-actions">
              <label class="toggle small">
                <input id="compareToggle" type="checkbox" />
                <span class="toggle-ui" aria-hidden="true"></span>
                Comparar A/B
              </label>
              <button class="secondary" id="download">
                ⬇️ Descargar imagen
              </button>
            </div>
          </div>
          <div class="comparison-grid" id="comparisonGrid">
            <div>
              <p>Imagen A</p>
              <img id="compareA" alt="Vista previa de la imagen A" />
            </div>
            <div>
              <p>Imagen B</p>
              <img id="compareB" alt="Vista previa de la imagen B" />
            </div>
          </div>
          <div class="result-canvas">
            <canvas id="canvasOut"></canvas>
          </div>
        </section>
      </section>
    </main>
  </div>
</body>
</html>
